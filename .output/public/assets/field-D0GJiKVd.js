import{x as It,r as _,j as A,y as Dt,c as K,A as kt}from"./main-DU4EUtQO.js";const B=new WeakMap,Q=new WeakMap,tt={current:[]};let ot=!1,z=0;const U=new Set,G=new Map;function St(s){const r=Array.from(s).sort((e,t)=>e instanceof T&&e.options.deps.includes(t)?1:t instanceof T&&t.options.deps.includes(e)?-1:0);for(const e of r){if(tt.current.includes(e))continue;tt.current.push(e),e.recompute();const t=Q.get(e);if(t)for(const i of t){const a=B.get(i);a&&St(a)}}}function _t(s){const r={prevVal:s.prevState,currentVal:s.state};for(const e of s.listeners)e(r)}function Ot(s){const r={prevVal:s.prevState,currentVal:s.state};for(const e of s.listeners)e(r)}function Vt(s){if(z>0&&!G.has(s)&&G.set(s,s.prevState),U.add(s),!(z>0)&&!ot)try{for(ot=!0;U.size>0;){const r=Array.from(U);U.clear();for(const e of r){const t=G.get(e)??e.prevState;e.prevState=t,_t(e)}for(const e of r){const t=B.get(e);t&&(tt.current.push(e),St(t))}for(const e of r){const t=B.get(e);if(t)for(const i of t)Ot(i)}}}finally{ot=!1,tt.current=[],G.clear()}}function L(s){z++;try{s()}finally{if(z--,z===0){const r=U.values().next().value;r&&Vt(r)}}}function Ct(s){return typeof s=="function"}class et{constructor(r,e){this.listeners=new Set,this.subscribe=t=>{var i,a;this.listeners.add(t);const n=(a=(i=this.options)==null?void 0:i.onSubscribe)==null?void 0:a.call(i,t,this);return()=>{this.listeners.delete(t),n?.()}},this.prevState=r,this.state=r,this.options=e}setState(r){var e,t,i;this.prevState=this.state,(e=this.options)!=null&&e.updateFn?this.state=this.options.updateFn(this.prevState)(r):Ct(r)?this.state=r(this.prevState):this.state=r,(i=(t=this.options)==null?void 0:t.onUpdate)==null||i.call(t),Vt(this)}}class T{constructor(r){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const e=this.options.deps.length,t=new Array(e),i=new Array(e);for(let a=0;a<e;a++){const n=this.options.deps[a];t[a]=n.prevState,i[a]=n.state}return this.lastSeenDepValues=i,{prevDepVals:t,currDepVals:i,prevVal:this.prevState??void 0}},this.recompute=()=>{var e,t;this.prevState=this.state;const i=this.getDepVals();this.state=this.options.fn(i),(t=(e=this.options).onUpdate)==null||t.call(e)},this.checkIfRecalculationNeededDeeply=()=>{for(const a of this.options.deps)a instanceof T&&a.checkIfRecalculationNeededDeeply();let e=!1;const t=this.lastSeenDepValues,{currDepVals:i}=this.getDepVals();for(let a=0;a<i.length;a++)if(i[a]!==t[a]){e=!0;break}e&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const e of this._subscriptions)e()}),this.subscribe=e=>{var t,i;this.listeners.add(e);const a=(i=(t=this.options).onSubscribe)==null?void 0:i.call(t,e,this);return()=>{this.listeners.delete(e),a?.()}},this.options=r,this.state=r.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(r=this.options.deps){for(const e of r)if(e instanceof T)e.registerOnGraph(),this.registerOnGraph(e.options.deps);else if(e instanceof et){let t=B.get(e);t||(t=new Set,B.set(e,t)),t.add(this);let i=Q.get(this);i||(i=new Set,Q.set(this,i)),i.add(e)}}unregisterFromGraph(r=this.options.deps){for(const e of r)if(e instanceof T)this.unregisterFromGraph(e.options.deps);else if(e instanceof et){const t=B.get(e);t&&t.delete(this);const i=Q.get(this);i&&i.delete(e)}}}function xt(s){return typeof s=="function"}function mt(s,...r){return xt(s)?s(...r):s}function Pt(s){return s||(typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"")}class Ft{#s=!0;#t;#e;#a;#i;#r;#n;#l;#d=0;#h=5;#o=!1;#c=()=>{this.debugLog("Connected to event bus"),this.#r=!0,this.#o=!1,this.debugLog("Emitting queued events",this.#i),this.#i.forEach(r=>this.emitEventToBus(r)),this.#i=[],this.stopConnectLoop(),this.#e().removeEventListener("tanstack-connect-success",this.#c)};#u=()=>{if(this.#d<this.#h){this.#d++,this.dispatchCustomEvent("tanstack-connect",{});return}this.#e().removeEventListener("tanstack-connect",this.#u),this.debugLog("Max retries reached, giving up on connection"),this.stopConnectLoop()};#f=()=>{this.#o||(this.#o=!0,this.#e().addEventListener("tanstack-connect-success",this.#c),this.#u())};constructor({pluginId:r,debug:e=!1,enabled:t=!0,reconnectEveryMs:i=300}){this.#t=r,this.#s=t,this.#e=this.getGlobalTarget,this.#a=e,this.debugLog(" Initializing event subscription for plugin",this.#t),this.#i=[],this.#r=!1,this.#n=null,this.#l=i}startConnectLoop(){this.#n!==null||this.#r||(this.debugLog(`Starting connect loop (every ${this.#l}ms)`),this.#n=setInterval(this.#u,this.#l))}stopConnectLoop(){this.#o=!1,this.#n!==null&&(clearInterval(this.#n),this.#n=null,this.debugLog("Stopped connect loop"))}debugLog(...r){this.#a&&console.log(`ðŸŒ´ [tanstack-devtools:${this.#t}-plugin]`,...r)}getGlobalTarget(){if(typeof globalThis<"u"&&globalThis.__TANSTACK_EVENT_TARGET__)return this.debugLog("Using global event target"),globalThis.__TANSTACK_EVENT_TARGET__;if(typeof window<"u"&&typeof window.addEventListener<"u")return this.debugLog("Using window as event target"),window;const r=typeof EventTarget<"u"?new EventTarget:void 0;return typeof r>"u"||typeof r.addEventListener>"u"?(this.debugLog("No event mechanism available, running in non-web environment"),{addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!1}):(this.debugLog("Using new EventTarget as fallback"),r)}getPluginId(){return this.#t}dispatchCustomEventShim(r,e){try{const t=new Event(r,{detail:e});this.#e().dispatchEvent(t)}catch{this.debugLog("Failed to dispatch shim event")}}dispatchCustomEvent(r,e){try{this.#e().dispatchEvent(new CustomEvent(r,{detail:e}))}catch{this.dispatchCustomEventShim(r,e)}}emitEventToBus(r){this.debugLog("Emitting event to client bus",r),this.dispatchCustomEvent("tanstack-dispatch-event",r)}emit(r,e){if(!this.#s){this.debugLog("Event bus client is disabled, not emitting event",r,e);return}if(!this.#r){this.debugLog("Bus not available, will be pushed as soon as connected"),this.#i.push({type:`${this.#t}:${r}`,payload:e,pluginId:this.#t}),typeof CustomEvent<"u"&&!this.#o&&(this.#f(),this.startConnectLoop());return}return this.emitEventToBus({type:`${this.#t}:${r}`,payload:e,pluginId:this.#t})}on(r,e){const t=`${this.#t}:${r}`;if(!this.#s)return this.debugLog("Event bus client is disabled, not registering event",t),()=>{};const i=a=>{this.debugLog("Received event from bus",a.detail),e(a.detail)};return this.#e().addEventListener(t,i),this.debugLog("Registered event to bus",t),()=>{this.#e().removeEventListener(t,i)}}onAll(r){if(!this.#s)return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const e=t=>{const i=t.detail;r(i)};return this.#e().addEventListener("tanstack-devtools-global",e),()=>this.#e().removeEventListener("tanstack-devtools-global",e)}onAllPluginEvents(r){if(!this.#s)return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const e=t=>{const i=t.detail;this.#t&&i.pluginId!==this.#t||r(i)};return this.#e().addEventListener("tanstack-devtools-global",e),()=>this.#e().removeEventListener("tanstack-devtools-global",e)}}class $t extends Ft{constructor(r){super({pluginId:"pacer",debug:r?.debug})}}const Bt=(s,r)=>{Et.emit(s,r)},Et=new $t;function vt(){return{executionCount:0,isPending:!1,lastArgs:void 0,lastExecutionTime:0,nextExecutionTime:0,status:"idle",maybeExecuteCount:0}}const Rt={enabled:!0,leading:!0,trailing:!0,wait:0};class Nt{constructor(r,e){this.fn=r,this.store=new et(vt()),this.setOptions=t=>{this.options={...this.options,...t},this.#e()||this.cancel()},this.#t=t=>{this.store.setState(i=>{const a={...i,...t},{isPending:n}=a;return{...a,status:this.#e()?n?"pending":"idle":"disabled"}}),Bt("Throttler",this)},this.#e=()=>!!mt(this.options.enabled,this),this.#a=()=>mt(this.options.wait,this),this.maybeExecute=(...t)=>{this.#t({maybeExecuteCount:this.store.state.maybeExecuteCount+1});const i=Date.now(),a=i-this.store.state.lastExecutionTime,n=this.#a();if(this.options.leading&&a>=n)this.#i(...t);else if(this.#t({lastArgs:t}),!this.#s&&this.options.trailing){const d=this.store.state.lastExecutionTime?i-this.store.state.lastExecutionTime:0,u=n-d;this.#t({isPending:!0}),this.#s=setTimeout(()=>{const{lastArgs:l}=this.store.state;l!==void 0&&this.#i(...l)},u)}},this.#i=(...t)=>{if(!this.#e())return;this.fn(...t);const i=Date.now(),a=i+this.#a();this.#r(),this.#t({executionCount:this.store.state.executionCount+1,lastExecutionTime:i,nextExecutionTime:a,isPending:!1,lastArgs:void 0}),this.options.onExecute?.(t,this),setTimeout(()=>{this.store.state.isPending||this.#t({nextExecutionTime:void 0})},this.#a())},this.flush=()=>{this.store.state.isPending&&this.store.state.lastArgs&&this.#i(...this.store.state.lastArgs)},this.#r=()=>{this.#s&&(clearTimeout(this.#s),this.#s=void 0)},this.cancel=()=>{this.#r(),this.#t({lastArgs:void 0,isPending:!1})},this.reset=()=>{this.#t(vt())},this.key=Pt(e.key),this.options={...Rt,...e},this.#t(this.options.initialState??{}),Et.on("d-Throttler",t=>{t.payload.key===this.key&&(this.#t(t.payload.store.state),this.setOptions(t.payload.options))})}#s;#t;#e;#a;#i;#r}function Ut(s,r){return new Nt(s,r).maybeExecute}function rt(s,r){return typeof s=="function"?s(r):s}function W(s,r){return ft(r).reduce((t,i)=>{if(t===null)return null;if(typeof t<"u")return t[i]},s)}function j(s,r,e){const t=ft(r);function i(a){if(!t.length)return rt(e,a);const n=t.shift();if(typeof n=="string"||typeof n=="number"&&!Array.isArray(a))return typeof a=="object"?(a===null&&(a={}),{...a,[n]:i(a[n])}):{[n]:i()};if(Array.isArray(a)&&typeof n=="number"){const d=a.slice(0,n);return[...d.length?d:new Array(n),i(a[n]),...a.slice(n+1)]}return[...new Array(n),i()]}return i(s)}function Wt(s,r){const e=ft(r);function t(i){if(!i)return;if(e.length===1){const n=e[0];if(Array.isArray(i)&&typeof n=="number")return i.filter((l,f)=>f!==n);const{[n]:d,...u}=i;return u}const a=e.shift();if(typeof a=="string"&&typeof i=="object")return{...i,[a]:t(i[a])};if(typeof a=="number"&&Array.isArray(i)){if(a>=i.length)return i;const n=i.slice(0,a);return[...n.length?n:new Array(a),t(i[a]),...i.slice(a+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return t(s)}const zt=/^(\d+)$/gm,Kt=/\.(\d+)(?=\.)/gm,Gt=/^(\d+)\./gm,jt=/\.(\d+$)/gm,qt=/\.{2,}/gm,ut="__int__",q=`${ut}$1`;function ft(s){if(Array.isArray(s))return[...s];if(typeof s!="string")throw new Error("Path must be a string.");return s.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(zt,q).replace(Kt,`.${q}.`).replace(Gt,`${q}.`).replace(jt,`.${q}`).replace(qt,".").split(".").map(r=>{if(r.startsWith(ut)){const e=r.substring(ut.length),t=parseInt(e,10);return String(t)===e?t:e}return r})}function Ht(s){return!(Array.isArray(s)&&s.length===0)}function dt(s,r){const e=t=>t.validators.filter(Boolean).map(i=>({cause:i.cause,validate:i.fn}));return r.validationLogic({form:r.form,validators:r.validators,event:{type:s,async:!1},runValidation:e})}function ct(s,r){const{asyncDebounceMs:e}=r,{onBlurAsyncDebounceMs:t,onChangeAsyncDebounceMs:i,onDynamicAsyncDebounceMs:a}=r.validators||{},n=e??0,d=u=>u.validators.filter(Boolean).map(l=>{const f=l?.cause||s;let c=n;switch(f){case"change":c=i??n;break;case"blur":c=t??n;break;case"dynamic":c=a??n;break;case"submit":c=0;break}return s==="submit"&&(c=0),{cause:f,validate:l.fn,debounceMs:c}});return r.validationLogic({form:r.form,validators:r.validators,event:{type:s,async:!0},runValidation:d})}const ht=s=>!!s&&typeof s=="object"&&"fields"in s;function P(s,r){if(Object.is(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;if(s instanceof Date&&r instanceof Date)return s.getTime()===r.getTime();if(s instanceof Map&&r instanceof Map){if(s.size!==r.size)return!1;for(const[i,a]of s)if(!r.has(i)||!Object.is(a,r.get(i)))return!1;return!0}if(s instanceof Set&&r instanceof Set){if(s.size!==r.size)return!1;for(const i of s)if(!r.has(i))return!1;return!0}const e=Object.keys(s),t=Object.keys(r);if(e.length!==t.length)return!1;for(const i of e)if(!t.includes(i)||!P(s[i],r[i]))return!1;return!0}const gt=({newFormValidatorError:s,isPreviousErrorFromFormValidator:r,previousErrorValue:e})=>s?{newErrorValue:s,newSource:"form"}:r?{newErrorValue:void 0,newSource:void 0}:e?{newErrorValue:e,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},pt=({formLevelError:s,fieldLevelError:r})=>r?{newErrorValue:r,newSource:"field"}:s?{newErrorValue:s,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function F(s,r){return s==null?r:{...s,...r}}let C=256;const Y=[];let H;for(;C--;)Y[C]=(C+256).toString(16).substring(1);function Xt(){let s=0,r,e="";if(!H||C+16>256){for(H=new Array(256),s=256;s--;)H[s]=256*Math.random()|0;s=0,C=0}for(;s<16;s++)r=H[C+s],s===6?e+=Y[r&15|64]:s===8?e+=Y[r&63|128]:e+=Y[r],s&1&&s>1&&s<11&&(e+="-");return C++,e}const $=s=>{if(!s.validators)return s.runValidation({validators:[],form:s.form});const r=s.event.async,e=r?void 0:{fn:s.validators.onMount,cause:"mount"},t={fn:r?s.validators.onChangeAsync:s.validators.onChange,cause:"change"},i={fn:r?s.validators.onBlurAsync:s.validators.onBlur,cause:"blur"},a={fn:r?s.validators.onSubmitAsync:s.validators.onSubmit,cause:"submit"},n=r?void 0:{fn:()=>{},cause:"server"};switch(s.event.type){case"mount":return s.runValidation({validators:[e],form:s.form});case"submit":return s.runValidation({validators:[t,i,a,n],form:s.form});case"server":return s.runValidation({validators:[],form:s.form});case"blur":return s.runValidation({validators:[i,n],form:s.form});case"change":return s.runValidation({validators:[t,n],form:s.form});default:throw new Error(`Unknown validation event type: ${s.event.type}`)}};function Jt(s,r){const e=new Map;for(const t of s){const i=t.path??[];let a=r,n="";for(let d=0;d<i.length;d++){const u=i[d];if(u===void 0)continue;const l=typeof u=="object"?u.key:u,f=Number(l);Array.isArray(a)&&!Number.isNaN(f)?n+=`[${f}]`:n+=(d>0?".":"")+String(l),typeof a=="object"&&a!==null?a=a[l]:a=void 0}e.set(n,(e.get(n)??[]).concat(t))}return Object.fromEntries(e)}const Mt=(s,r)=>{const e=Jt(s,r);return{form:e,fields:e}},R={validate({value:s,validationSource:r},e){const t=e["~standard"].validate(s);if(t instanceof Promise)throw new Error("async function passed to sync validator");if(t.issues)return r==="field"?t.issues:Mt(t.issues,s)},async validateAsync({value:s,validationSource:r},e){const t=await e["~standard"].validate(s);if(t.issues)return r==="field"?t.issues:Mt(t.issues,s)}},wt=s=>!!s&&"~standard"in s,st={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function X(s){function r(c,o,m,h){const v=t(c,o,m,h);({insert:()=>d(v,c,o),remove:()=>u(v),swap:()=>h!==void 0&&f(v,c,o,h),move:()=>h!==void 0&&l(v,c,o,h)})[m]()}function e(c,o){return`${c}[${o}]`}function t(c,o,m,h){const v=[e(c,o)];if(m==="swap")v.push(e(c,h));else if(m==="move"){const[g,M]=[Math.min(o,h),Math.max(o,h)];for(let p=g;p<=M;p++)v.push(e(c,p))}else{const g=s.getFieldValue(c),M=Array.isArray(g)?g.length:0;for(let p=o+1;p<M;p++)v.push(e(c,p))}return Object.keys(s.fieldInfo).filter(g=>v.some(M=>g.startsWith(M)))}function i(c,o){return c.replace(/\[(\d+)\]/,(m,h)=>{const v=parseInt(h,10);return`[${o==="up"?v+1:Math.max(0,v-1)}]`})}function a(c,o){(o==="up"?c:[...c].reverse()).forEach(h=>{const v=i(h.toString(),o),g=s.getFieldMeta(v);g?s.setFieldMeta(h,g):s.setFieldMeta(h,n())})}const n=()=>st,d=(c,o,m)=>{a(c,"down"),c.forEach(h=>{h.toString().startsWith(e(o,m))&&s.setFieldMeta(h,n())})},u=c=>{a(c,"up")},l=(c,o,m,h)=>{const v=new Map(Object.keys(s.fieldInfo).filter(g=>g.startsWith(e(o,m))).map(g=>[g,s.getFieldMeta(g)]));a(c,m<h?"up":"down"),Object.keys(s.fieldInfo).filter(g=>g.startsWith(e(o,h))).forEach(g=>{const M=g.replace(e(o,h),e(o,m)),p=v.get(M);p&&s.setFieldMeta(g,p)})},f=(c,o,m,h)=>{c.forEach(v=>{if(!v.toString().startsWith(e(o,m)))return;const g=v.toString().replace(e(o,m),e(o,h)),[M,p]=[s.getFieldMeta(v),s.getFieldMeta(g)];M&&s.setFieldMeta(g,M),p&&s.setFieldMeta(v,p)})};return{handleArrayFieldMetaShift:r}}class Qt extends Ft{constructor(){super({pluginId:"form-devtools",reconnectEveryMs:1e3})}}const w=new Qt;function lt(s){return{values:s.values??{},errorMap:s.errorMap??{},fieldMetaBase:s.fieldMetaBase??{},isSubmitted:s.isSubmitted??!1,isSubmitting:s.isSubmitting??!1,isValidating:s.isValidating??!1,submissionAttempts:s.submissionAttempts??0,isSubmitSuccessful:s.isSubmitSuccessful??!1,validationMetaMap:s.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}}}class Yt{constructor(r){this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{const t=this.fieldMetaDerived.mount(),i=this.store.mount(),a=()=>{t(),i(),w.emit("form-unmounted",{id:this._formId})};this.options.listeners?.onMount?.({formApi:this});const{onMount:n}=this.options.validators||{};return w.emit("form-api",{id:this._formId,state:this.store.state,options:this.options}),n&&this.validateSync("mount"),a},this.update=t=>{if(!t)return;const i=this.options;this.options=t;const a=!!t.transform?.deps?.some((u,l)=>u!==this.prevTransformArray[l]),n=t.defaultValues&&!P(t.defaultValues,i.defaultValues)&&!this.state.isTouched,d=!P(t.defaultState,i.defaultState)&&!this.state.isTouched;!n&&!d&&!a||(L(()=>{this.baseStore.setState(()=>lt(Object.assign({},this.state,d?t.defaultState:{},n?{values:t.defaultValues}:{},a?{_force_re_eval:!this.state._force_re_eval}:{})))}),w.emit("form-api",{id:this._formId,state:this.store.state,options:this.options}))},this.reset=(t,i)=>{const{fieldMeta:a}=this.state,n=this.resetFieldMeta(a);t&&!i?.keepDefaultValues&&(this.options={...this.options,defaultValues:t}),this.baseStore.setState(()=>lt({...this.options.defaultState,values:t??this.options.defaultValues??this.options.defaultState?.values,fieldMetaBase:n}))},this.validateAllFields=async t=>{const i=[];return L(()=>{Object.values(this.fieldInfo).forEach(n=>{if(!n.instance)return;const d=n.instance;i.push(Promise.resolve().then(()=>d.validate(t,{skipFormValidation:!0}))),n.instance.state.meta.isTouched||n.instance.setMeta(u=>({...u,isTouched:!0}))})}),(await Promise.all(i)).flat()},this.validateArrayFieldsStartingFrom=async(t,i,a)=>{const n=this.getFieldValue(t),d=Array.isArray(n)?Math.max(n.length-1,0):null,u=[`${t}[${i}]`];for(let o=i+1;o<=(d??0);o++)u.push(`${t}[${o}]`);const l=Object.keys(this.fieldInfo).filter(o=>u.some(m=>o.startsWith(m))),f=[];return L(()=>{l.forEach(o=>{f.push(Promise.resolve().then(()=>this.validateField(o,a)))})}),(await Promise.all(f)).flat()},this.validateField=(t,i)=>{const a=this.fieldInfo[t]?.instance;return a?(a.state.meta.isTouched||a.setMeta(n=>({...n,isTouched:!0})),a.validate(i)):[]},this.validateSync=t=>{const i=dt(t,{...this.options,form:this,validationLogic:this.options.validationLogic||$});let a=!1;const n={};return L(()=>{for(const l of i){if(!l.validate)continue;const f=this.runValidator({validate:l.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:c,fieldErrors:o}=Z(f),m=N(l.cause);for(const h of Object.keys(this.state.fieldMeta)){if(this.baseStore.state.fieldMetaBase[h]===void 0)continue;const v=this.getFieldMeta(h);if(!v)continue;const{errorMap:g,errorSourceMap:M}=v,p=o?.[h],{newErrorValue:y,newSource:V}=gt({newFormValidatorError:p,isPreviousErrorFromFormValidator:M?.[m]==="form",previousErrorValue:g?.[m]});V==="form"&&(n[h]={...n[h],[m]:p}),g?.[m]!==y&&this.setFieldMeta(h,S=>({...S,errorMap:{...S.errorMap,[m]:y},errorSourceMap:{...S.errorSourceMap,[m]:V}}))}this.state.errorMap?.[m]!==c&&this.baseStore.setState(h=>({...h,errorMap:{...h.errorMap,[m]:c}})),(c||o)&&(a=!0)}const d=N("submit");this.state.errorMap?.[d]&&t!=="submit"&&!a&&this.baseStore.setState(l=>({...l,errorMap:{...l.errorMap,[d]:void 0}}));const u=N("server");this.state.errorMap?.[u]&&t!=="server"&&!a&&this.baseStore.setState(l=>({...l,errorMap:{...l.errorMap,[u]:void 0}}))}),{hasErrored:a,fieldsErrorMap:n}},this.validateAsync=async t=>{const i=ct(t,{...this.options,form:this,validationLogic:this.options.validationLogic||$});this.state.isFormValidating||this.baseStore.setState(l=>({...l,isFormValidating:!0}));const a=[];let n;for(const l of i){if(!l.validate)continue;const f=N(l.cause);this.state.validationMetaMap[f]?.lastAbortController.abort();const o=new AbortController;this.state.validationMetaMap[f]={lastAbortController:o},a.push(new Promise(async m=>{let h;try{h=await new Promise((p,y)=>{setTimeout(async()=>{if(o.signal.aborted)return p(void 0);try{p(await this.runValidator({validate:l.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:o.signal},type:"validateAsync"}))}catch(V){y(V)}},l.debounceMs)})}catch(p){h=p}const{formError:v,fieldErrors:g}=Z(h);g&&(n=n?{...n,...g}:g);const M=N(l.cause);for(const p of Object.keys(this.state.fieldMeta)){if(this.baseStore.state.fieldMetaBase[p]===void 0)continue;const y=this.getFieldMeta(p);if(!y)continue;const{errorMap:V,errorSourceMap:S}=y,I=n?.[p],{newErrorValue:D,newSource:E}=gt({newFormValidatorError:I,isPreviousErrorFromFormValidator:S?.[M]==="form",previousErrorValue:V?.[M]});V?.[M]!==D&&this.setFieldMeta(p,k=>({...k,errorMap:{...k.errorMap,[M]:D},errorSourceMap:{...k.errorSourceMap,[M]:E}}))}this.baseStore.setState(p=>({...p,errorMap:{...p.errorMap,[M]:v}})),m(n?{fieldErrors:n,errorMapKey:M}:void 0)}))}let d=[];const u={};if(a.length){d=await Promise.all(a);for(const l of d)if(l?.fieldErrors){const{errorMapKey:f}=l;for(const[c,o]of Object.entries(l.fieldErrors)){const h={...u[c]||{},[f]:o};u[c]=h}}}return this.baseStore.setState(l=>({...l,isFormValidating:!1})),u},this.validate=t=>{const{hasErrored:i,fieldsErrorMap:a}=this.validateSync(t);return i&&!this.options.asyncAlways?a:this.validateAsync(t)},this.getFieldValue=t=>W(this.state.values,t),this.getFieldMeta=t=>this.state.fieldMeta[t],this.getFieldInfo=t=>this.fieldInfo[t]||={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}},this.setFieldMeta=(t,i)=>{this.baseStore.setState(a=>({...a,fieldMetaBase:{...a.fieldMetaBase,[t]:rt(i,a.fieldMetaBase[t])}}))},this.resetFieldMeta=t=>Object.keys(t).reduce((i,a)=>{const n=a;return i[n]=st,i},{}),this.setFieldValue=(t,i,a)=>{const n=a?.dontUpdateMeta??!1,d=a?.dontRunListeners??!1,u=a?.dontValidate??!1;L(()=>{n||this.setFieldMeta(t,l=>({...l,isTouched:!0,isDirty:!0,errorMap:{...l?.errorMap,onMount:void 0}})),this.baseStore.setState(l=>({...l,values:j(l.values,t,i)}))}),d||this.getFieldInfo(t).instance?.triggerOnChangeListener(),u||this.validateField(t,"change")},this.deleteField=t=>{const a=[...Object.keys(this.fieldInfo).filter(n=>{const d=t.toString();return n!==d&&n.startsWith(d)}),t];this.baseStore.setState(n=>{const d={...n};return a.forEach(u=>{d.values=Wt(d.values,u),delete this.fieldInfo[u],delete d.fieldMetaBase[u]}),d})},this.pushFieldValue=(t,i,a)=>{this.setFieldValue(t,n=>[...Array.isArray(n)?n:[],i],a)},this.insertFieldValue=async(t,i,a,n)=>{this.setFieldValue(t,u=>[...u.slice(0,i),a,...u.slice(i)],F(n,{dontValidate:!0}));const d=n?.dontValidate??!1;d||await this.validateField(t,"change"),X(this).handleArrayFieldMetaShift(t,i,"insert"),d||await this.validateArrayFieldsStartingFrom(t,i,"change")},this.replaceFieldValue=async(t,i,a,n)=>{this.setFieldValue(t,u=>u.map((l,f)=>f===i?a:l),F(n,{dontValidate:!0})),(n?.dontValidate??!1)||(await this.validateField(t,"change"),await this.validateArrayFieldsStartingFrom(t,i,"change"))},this.removeFieldValue=async(t,i,a)=>{const n=this.getFieldValue(t),d=Array.isArray(n)?Math.max(n.length-1,0):null;if(this.setFieldValue(t,l=>l.filter((f,c)=>c!==i),F(a,{dontValidate:!0})),X(this).handleArrayFieldMetaShift(t,i,"remove"),d!==null){const l=`${t}[${d}]`;this.deleteField(l)}(a?.dontValidate??!1)||(await this.validateField(t,"change"),await this.validateArrayFieldsStartingFrom(t,i,"change"))},this.swapFieldValues=(t,i,a,n)=>{this.setFieldValue(t,u=>{const l=u[i],f=u[a];return j(j(u,`${i}`,f),`${a}`,l)},F(n,{dontValidate:!0})),X(this).handleArrayFieldMetaShift(t,i,"swap",a),(n?.dontValidate??!1)||(this.validateField(t,"change"),this.validateField(`${t}[${i}]`,"change"),this.validateField(`${t}[${a}]`,"change"))},this.moveFieldValues=(t,i,a,n)=>{this.setFieldValue(t,u=>{const l=[...u];return l.splice(a,0,l.splice(i,1)[0]),l},F(n,{dontValidate:!0})),X(this).handleArrayFieldMetaShift(t,i,"move",a),(n?.dontValidate??!1)||(this.validateField(t,"change"),this.validateField(`${t}[${i}]`,"change"),this.validateField(`${t}[${a}]`,"change"))},this.clearFieldValues=(t,i)=>{const a=this.getFieldValue(t),n=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(t,[],F(i,{dontValidate:!0})),n!==null)for(let u=0;u<=n;u++){const l=`${t}[${u}]`;this.deleteField(l)}(i?.dontValidate??!1)||this.validateField(t,"change")},this.resetField=t=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[t]:st},values:this.options.defaultValues?j(i.values,t,W(this.options.defaultValues,t)):i.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((t,[i,a])=>(Object.keys(a).length&&a.errors.length&&(t[i]={errors:a.errors,errorMap:a.errorMap}),t),{})}),this.parseValuesWithSchema=t=>R.validate({value:this.state.values,validationSource:"form"},t),this.parseValuesWithSchemaAsync=t=>R.validateAsync({value:this.state.values,validationSource:"form"},t),this.timeoutIds={validations:{},listeners:{},formListeners:{}},this._formId=r?.formId??Xt(),this._devtoolsSubmissionOverride=!1,this.baseStore=new et(lt({...r?.defaultState,values:r?.defaultValues??r?.defaultState?.values})),this.fieldMetaDerived=new T({deps:[this.baseStore],fn:({prevDepVals:t,currDepVals:i,prevVal:a})=>{const n=a,d=t?.[0],u=i[0];let l=0;const f={};for(const c of Object.keys(u.fieldMetaBase)){const o=u.fieldMetaBase[c],m=d?.fieldMetaBase[c],h=n?.[c],v=W(u.values,c);let g=h?.errors;if(!m||o.errorMap!==m.errorMap){g=Object.values(o.errorMap??{}).filter(S=>S!==void 0);const V=this.getFieldInfo(c)?.instance;V&&!V.options.disableErrorFlat&&(g=g?.flat(1))}const M=!Ht(g??[]),p=!o.isDirty,y=P(v,W(this.options.defaultValues,c))||P(v,this.getFieldInfo(c)?.instance?.options.defaultValue);if(h&&h.isPristine===p&&h.isValid===M&&h.isDefaultValue===y&&h.errors===g&&o===m){f[c]=h,l++;continue}f[c]={...o,errors:g,isPristine:p,isValid:M,isDefaultValue:y}}return Object.keys(u.fieldMetaBase).length&&n&&l===Object.keys(u.fieldMetaBase).length?n:f}}),this.store=new T({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:t,currDepVals:i,prevVal:a})=>{const n=a,d=t?.[0],u=i[0],l=i[1],f=Object.values(l).filter(Boolean),c=f.some(b=>b.isValidating),o=f.every(b=>b.isValid),m=f.some(b=>b.isTouched),h=f.some(b=>b.isBlurred),v=f.every(b=>b.isDefaultValue),g=m&&u.errorMap?.onMount,M=f.some(b=>b.isDirty),p=!M,y=!!(u.errorMap?.onMount||f.some(b=>b?.errorMap?.onMount)),V=!!c;let S=n?.errors??[];(!d||u.errorMap!==d.errorMap)&&(S=Object.values(u.errorMap).reduce((b,O)=>O===void 0?b:O&&ht(O)?(b.push(O.form),b):(b.push(O),b),[]));const I=S.length===0,D=o&&I,E=this.options.canSubmitWhenInvalid??!1,k=u.submissionAttempts===0&&!m&&!y||!V&&!u.isSubmitting&&D||E;let x=u.errorMap;if(g&&(S=S.filter(b=>b!==u.errorMap.onMount),x=Object.assign(x,{onMount:void 0})),n&&d&&n.errorMap===x&&n.fieldMeta===this.fieldMetaDerived.state&&n.errors===S&&n.isFieldsValidating===c&&n.isFieldsValid===o&&n.isFormValid===I&&n.isValid===D&&n.canSubmit===k&&n.isTouched===m&&n.isBlurred===h&&n.isPristine===p&&n.isDefaultValue===v&&n.isDirty===M&&P(d,u))return n;let at={...u,errorMap:x,fieldMeta:this.fieldMetaDerived.state,errors:S,isFieldsValidating:c,isFieldsValid:o,isFormValid:I,isValid:D,canSubmit:k,isTouched:m,isBlurred:h,isPristine:p,isDefaultValue:v,isDirty:M};const nt=this.options.transform?.deps??[];if(nt.length!==this.prevTransformArray.length||nt.some((b,O)=>b!==this.prevTransformArray[O])){const b=Object.assign({},this,{state:at});this.options.transform?.fn(b),at=b.state,this.prevTransformArray=nt}return at}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(r||{});const e=Ut(t=>w.emit("form-state",{id:this._formId,state:t}),{wait:300});this.store.subscribe(()=>{e(this.store.state)}),w.on("request-form-state",t=>{t.payload.id===this._formId&&w.emit("form-api",{id:this._formId,state:this.store.state,options:this.options})}),w.on("request-form-reset",t=>{t.payload.id===this._formId&&this.reset()}),w.on("request-form-force-submit",t=>{t.payload.id===this._formId&&(this._devtoolsSubmissionOverride=!0,this.handleSubmit(),this._devtoolsSubmissionOverride=!1)})}get state(){return this.store.state}get formId(){return this._formId}runValidator(r){return wt(r.validate)?R[r.type](r.value,r.validate):r.validate(r.value)}async handleSubmit(r){this.baseStore.setState(i=>({...i,isSubmitted:!1,submissionAttempts:i.submissionAttempts+1,isSubmitSuccessful:!1})),L(()=>{Object.values(this.fieldInfo).forEach(i=>{i.instance&&(i.instance.state.meta.isTouched||i.instance.setMeta(a=>({...a,isTouched:!0})))})});const e=r??this.options.onSubmitMeta;if(!this.state.canSubmit&&!this._devtoolsSubmissionOverride){this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e});return}this.baseStore.setState(i=>({...i,isSubmitting:!0}));const t=()=>{this.baseStore.setState(i=>({...i,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){t(),this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e}),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validateAllFields",errors:Object.values(this.state.fieldMeta).map(i=>i.errors).flat()});return}if(await this.validate("submit"),!this.state.isValid){t(),this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e}),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validate",errors:this.state.errors});return}L(()=>{Object.values(this.fieldInfo).forEach(i=>{i.instance?.options.listeners?.onSubmit?.({value:i.instance.state.value,fieldApi:i.instance})})}),this.options.listeners?.onSubmit?.({formApi:this,meta:e});try{await this.options.onSubmit?.({value:this.state.values,formApi:this,meta:e}),L(()=>{this.baseStore.setState(i=>({...i,isSubmitted:!0,isSubmitSuccessful:!0})),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!0}),t()})}catch(i){throw this.baseStore.setState(a=>({...a,isSubmitSuccessful:!1})),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"inflight",onError:i}),t(),i}}setErrorMap(r){L(()=>{Object.entries(r).forEach(([e,t])=>{const i=e;if(ht(t)){const{formError:a,fieldErrors:n}=Z(t);for(const d of Object.keys(this.fieldInfo))this.getFieldMeta(d)&&this.setFieldMeta(d,l=>({...l,errorMap:{...l.errorMap,[i]:n?.[d]},errorSourceMap:{...l.errorSourceMap,[i]:"form"}}));this.baseStore.setState(d=>({...d,errorMap:{...d.errorMap,[i]:a}}))}else this.baseStore.setState(a=>({...a,errorMap:{...a.errorMap,[i]:t}}))})})}}function Z(s){if(s){if(ht(s)){const r=Z(s.form).formError,e=s.fields;return{formError:r,fieldErrors:e}}return{formError:s}}return{formError:void 0}}function N(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}class Zt{constructor(r){this.options={},this.mount=()=>{const e=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const t=this.getInfo();t.instance=this,this.update(this.options);const{onMount:i}=this.options.validators||{};if(i){const a=this.runValidator({validate:i,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});a&&this.setMeta(n=>({...n,errorMap:{...n?.errorMap,onMount:a},errorSourceMap:{...n?.errorSourceMap,onMount:"field"}}))}return this.options.listeners?.onMount?.({value:this.state.value,fieldApi:this}),e},this.update=e=>{this.options=e;const t=this.name!==e.name;if(this.name=e.name,this.state.value===void 0){const i=W(e.form.options.defaultValues,e.name),a=e.defaultValue??i;t?this.setValue(n=>n||a,{dontUpdateMeta:!0}):a!==void 0&&this.setValue(a,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(e,t)=>{this.form.setFieldValue(this.name,e,F(t,{dontRunListeners:!0,dontValidate:!0})),t?.dontRunListeners||this.triggerOnChangeListener(),t?.dontValidate||this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=e=>this.form.setFieldMeta(this.name,e),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(e,t)=>{this.form.pushFieldValue(this.name,e,F(t,{dontRunListeners:!0})),t?.dontRunListeners||this.triggerOnChangeListener()},this.insertValue=(e,t,i)=>{this.form.insertFieldValue(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.replaceValue=(e,t,i)=>{this.form.replaceFieldValue(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.removeValue=(e,t)=>{this.form.removeFieldValue(this.name,e,F(t,{dontRunListeners:!0})),t?.dontRunListeners||this.triggerOnChangeListener()},this.swapValues=(e,t,i)=>{this.form.swapFieldValues(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.moveValue=(e,t,i)=>{this.form.moveFieldValues(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.clearValues=e=>{this.form.clearFieldValues(this.name,F(e,{dontRunListeners:!0})),e?.dontRunListeners||this.triggerOnChangeListener()},this.getLinkedFields=e=>{const t=Object.values(this.form.fieldInfo),i=[];for(const a of t){if(!a.instance)continue;const{onChangeListenTo:n,onBlurListenTo:d}=a.instance.options.validators||{};e==="change"&&n?.includes(this.name)&&i.push(a.instance),e==="blur"&&d?.includes(this.name)&&i.push(a.instance)}return i},this.validateSync=(e,t)=>{const i=dt(e,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||$}),n=this.getLinkedFields(e).reduce((l,f)=>{const c=dt(e,{...f.options,form:f.form,validationLogic:f.form.options.validationLogic||$});return c.forEach(o=>{o.field=f}),l.concat(c)},[]);let d=!1;L(()=>{const l=(f,c)=>{const o=J(c.cause),m=c.validate?bt(f.runValidator({validate:c.validate,value:{value:f.store.state.value,validationSource:"field",fieldApi:f},type:"validate"})):void 0,h=t[o],{newErrorValue:v,newSource:g}=pt({formLevelError:h,fieldLevelError:m});f.state.meta.errorMap?.[o]!==v&&f.setMeta(M=>({...M,errorMap:{...M.errorMap,[o]:v},errorSourceMap:{...M.errorSourceMap,[o]:g}})),v&&(d=!0)};for(const f of i)l(this,f);for(const f of n)f.validate&&l(f.field,f)});const u=J("submit");return this.state.meta.errorMap?.[u]&&e!=="submit"&&!d&&this.setMeta(l=>({...l,errorMap:{...l.errorMap,[u]:void 0},errorSourceMap:{...l.errorSourceMap,[u]:void 0}})),{hasErrored:d}},this.validateAsync=async(e,t)=>{const i=ct(e,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||$}),a=await t,n=this.getLinkedFields(e),d=n.reduce((o,m)=>{const h=ct(e,{...m.options,form:m.form,validationLogic:m.form.options.validationLogic||$});return h.forEach(v=>{v.field=m}),o.concat(h)},[]);this.state.meta.isValidating||this.setMeta(o=>({...o,isValidating:!0}));for(const o of n)o.setMeta(m=>({...m,isValidating:!0}));const u=[],l=[],f=(o,m,h)=>{const v=J(m.cause);o.getInfo().validationMetaMap[v]?.lastAbortController.abort();const M=new AbortController;this.getInfo().validationMetaMap[v]={lastAbortController:M},h.push(new Promise(async p=>{let y;try{y=await new Promise((E,k)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(M.signal.aborted)return E(void 0);try{E(await this.runValidator({validate:m.validate,value:{value:o.store.state.value,fieldApi:o,signal:M.signal,validationSource:"field"},type:"validateAsync"}))}catch(x){k(x)}},m.debounceMs)})}catch(E){y=E}if(M.signal.aborted)return p(void 0);const V=bt(y),S=a[this.name]?.[v],{newErrorValue:I,newSource:D}=pt({formLevelError:S,fieldLevelError:V});o.setMeta(E=>({...E,errorMap:{...E?.errorMap,[v]:I},errorSourceMap:{...E.errorSourceMap,[v]:D}})),p(I)}))};for(const o of i)o.validate&&f(this,o,u);for(const o of d)o.validate&&f(o.field,o,l);let c=[];(u.length||l.length)&&(c=await Promise.all(u),await Promise.all(l)),this.setMeta(o=>({...o,isValidating:!1}));for(const o of n)o.setMeta(m=>({...m,isValidating:!1}));return c.filter(Boolean)},this.validate=(e,t)=>{if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=t?.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(e),{hasErrored:a}=this.validateSync(e,i[this.name]??{});if(a&&!this.options.asyncAlways)return this.getInfo().validationMetaMap[J(e)]?.lastAbortController.abort(),this.state.meta.errors;const n=t?.skipFormValidation?Promise.resolve({}):this.form.validateAsync(e);return this.validateAsync(e,n)},this.handleChange=e=>{this.setValue(e)},this.handleBlur=()=>{this.state.meta.isTouched||this.setMeta(t=>({...t,isTouched:!0})),this.state.meta.isBlurred||this.setMeta(t=>({...t,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=e=>R.validate({value:this.state.value,validationSource:"field"},e),this.parseValueWithSchemaAsync=e=>R.validateAsync({value:this.state.value,validationSource:"field"},e),this.form=r.form,this.name=r.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new T({deps:[this.form.store],fn:()=>{const e=this.form.getFieldValue(this.name),t=this.form.getFieldMeta(this.name)??{...st,...r.defaultMeta};return{value:e,meta:t}}}),this.options=r}get state(){return this.store.state}runValidator(r){return wt(r.validate)?R[r.type](r.value,r.validate):r.validate(r.value)}setErrorMap(r){this.setMeta(e=>({...e,errorMap:{...e.errorMap,...r}}))}triggerOnBlurListener(){const r=this.form.options.listeners?.onBlurDebounceMs;r&&r>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this})},r)):this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this});const e=this.options.listeners?.onBlurDebounceMs;e&&e>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})},e)):this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})}triggerOnChangeListener(){const r=this.form.options.listeners?.onChangeDebounceMs;r&&r>0?(this.timeoutIds.formListeners.change&&clearTimeout(this.timeoutIds.formListeners.change),this.timeoutIds.formListeners.change=setTimeout(()=>{this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this})},r)):this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this});const e=this.options.listeners?.onChangeDebounceMs;e&&e>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})},e)):this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})}}function bt(s){if(s)return s}function J(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}function At(s,r=e=>e){return It.useSyncExternalStoreWithSelector(s.subscribe,()=>s.state,()=>s.state,r,te)}function te(s,r){if(Object.is(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;if(s instanceof Map&&r instanceof Map){if(s.size!==r.size)return!1;for(const[t,i]of s)if(!r.has(t)||!Object.is(i,r.get(t)))return!1;return!0}if(s instanceof Set&&r instanceof Set){if(s.size!==r.size)return!1;for(const t of s)if(!r.has(t))return!1;return!0}if(s instanceof Date&&r instanceof Date)return s.getTime()===r.getTime();const e=yt(s);if(e.length!==yt(r).length)return!1;for(let t=0;t<e.length;t++)if(!Object.prototype.hasOwnProperty.call(r,e[t])||!Object.is(s[e[t]],r[e[t]]))return!1;return!0}function yt(s){return Object.keys(s).concat(Object.getOwnPropertySymbols(s))}const it=typeof window<"u"?_.useLayoutEffect:_.useEffect;function ee(s){const[r]=_.useState(()=>{const t=new Zt({...s,form:s.form,name:s.name});return t.Field=Lt,t});return it(r.mount,[r]),it(()=>{r.update(s)}),At(r.store,s.mode==="array"?e=>[e.meta,Object.keys(e.value??[]).length]:void 0),r}const Lt=(({children:s,...r})=>{const e=ee(r),t=_.useMemo(()=>rt(s,e),[s,e,e.state.value,e.state.meta]);return A.jsx(A.Fragment,{children:t})});function se({form:s,selector:r,children:e}){const t=At(s.store,r);return rt(e,t)}function ue(s){const r=_.useId(),[e]=_.useState(()=>{const t=new Yt({...s,formId:r}),i=t;return i.Field=function(n){return A.jsx(Lt,{...n,form:t})},i.Subscribe=function(n){return A.jsx(se,{form:t,selector:n.selector,children:n.children})},i});return it(e.mount,[]),it(()=>{e.update(s)}),e}var ie="Label",Tt=_.forwardRef((s,r)=>A.jsx(Dt.label,{...s,ref:r,onMouseDown:e=>{e.target.closest("button, input, select, textarea")||(s.onMouseDown?.(e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));Tt.displayName=ie;var re=Tt;function ae({className:s,...r}){return A.jsx(re,{"data-slot":"label",className:K("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...r})}function de({className:s,...r}){return A.jsx("div",{"data-slot":"field-group",className:K("group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4",s),...r})}const ne=kt("group/field flex w-full gap-3 data-[invalid=true]:text-destructive",{variants:{orientation:{vertical:["flex-col [&>*]:w-full [&>.sr-only]:w-auto"],horizontal:["flex-row items-center","[&>[data-slot=field-label]]:flex-auto","has-[>[data-slot=field-content]]:items-start has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px"],responsive:["flex-col [&>*]:w-full [&>.sr-only]:w-auto @md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto","@md/field-group:[&>[data-slot=field-label]]:flex-auto","@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px"]}},defaultVariants:{orientation:"vertical"}});function ce({className:s,orientation:r="vertical",...e}){return A.jsx("div",{role:"group","data-slot":"field","data-orientation":r,className:K(ne({orientation:r}),s),...e})}function he({className:s,...r}){return A.jsx(ae,{"data-slot":"field-label",className:K("group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50","has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>*]:data-[slot=field]:p-4","has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10",s),...r})}function fe({className:s,children:r,errors:e,...t}){const i=_.useMemo(()=>{if(r)return r;if(!e?.length)return null;const a=[...new Map(e.map(n=>[n?.message,n])).values()];return a?.length==1?a[0]?.message:A.jsx("ul",{className:"ml-4 flex list-disc flex-col gap-1",children:a.map((n,d)=>n?.message&&A.jsx("li",{children:n.message},d))})},[r,e]);return i?A.jsx("div",{role:"alert","data-slot":"field-error",className:K("text-destructive text-sm font-normal",s),...t,children:i}):null}export{ce as F,he as a,fe as b,de as c,ue as u};
