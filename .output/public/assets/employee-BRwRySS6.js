import{c as Ae,j as e,R as G,C as Q,e as f,f as F,X as De,T as W,P as X,O as Y,B as w,r as l,g as J,h as ke,i as S,W as Ne,k as Z,l as I,m as we,D as Ee,n as ee,o as Se,p as z,q as _e,s as Re,u as Pe,t as A,v as Te,a as Ie,L as B,N as Fe}from"./main-Bv9S1MYm.js";import{j as ze,k as Me,E as Oe,l as Be,m as $,n as $e,o as qe,p as Le,q as Ue,u as E,r as Ke,t as Ve,v as He,a as T,U as Ge,w as Qe,b as We,D as Xe,c as Ye,i as Je,T as Ze,d as et,C as tt,f as k,x as at,g as ot}from"./use-client-table-BcbZZ325.js";import{u as rt,c as nt,F as q,a as L,I as U,b as K}from"./field-CkNVEhos.js";const st=[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M22 19h-6",key:"vcuq98"}]],it=Ae("user-round-plus",st);function lt({...t}){return e.jsx(G,{"data-slot":"dialog",...t})}function ct({...t}){return e.jsx(X,{"data-slot":"dialog-portal",...t})}function dt({className:t,...o}){return e.jsx(Y,{"data-slot":"dialog-overlay",className:f("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...o})}function ut({className:t,children:o,showCloseButton:a=!0,...r}){return e.jsxs(ct,{"data-slot":"dialog-portal",children:[e.jsx(dt,{}),e.jsxs(Q,{"data-slot":"dialog-content",className:f("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[o,a&&e.jsxs(F,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(De,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function pt({className:t,...o}){return e.jsx("div",{"data-slot":"dialog-header",className:f("flex flex-col gap-2 text-center sm:text-left",t),...o})}function mt({className:t,...o}){return e.jsx("div",{"data-slot":"dialog-footer",className:f("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...o})}function gt({className:t,...o}){return e.jsx(W,{"data-slot":"dialog-title",className:f("text-lg leading-none font-semibold",t),...o})}function ft({row:t,table:o}){const a=o.options.meta;function r({action:n}){if(!a?.rowActions)throw new Error("rowActions function is required");n==="delete"&&a.rowActions({row:t,variant:"delete"}),n==="edit"&&a.rowActions({row:t,variant:"edit"})}return e.jsxs(ze,{children:[e.jsx(Me,{asChild:!0,children:e.jsxs(w,{variant:"ghost",size:"icon",className:"data-[state=open]:bg-muted size-8",children:[e.jsx(Oe,{}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(Be,{align:"end",className:"w-[160px]",children:[e.jsx($,{onClick:()=>r({action:"edit"}),children:"Edit"}),e.jsx($e,{}),e.jsxs($,{variant:"destructive",onClick:()=>r({action:"delete"}),children:["Delete",e.jsx(qe,{children:"⌘⌫"})]})]})]})}var te="AlertDialog",[ht]=Z(te,[J]),C=J(),ae=t=>{const{__scopeAlertDialog:o,...a}=t,r=C(o);return e.jsx(G,{...r,...a,modal:!0})};ae.displayName=te;var xt="AlertDialogTrigger",oe=l.forwardRef((t,o)=>{const{__scopeAlertDialog:a,...r}=t,n=C(a);return e.jsx(ke,{...n,...r,ref:o})});oe.displayName=xt;var bt="AlertDialogPortal",re=t=>{const{__scopeAlertDialog:o,...a}=t,r=C(o);return e.jsx(X,{...r,...a})};re.displayName=bt;var vt="AlertDialogOverlay",ne=l.forwardRef((t,o)=>{const{__scopeAlertDialog:a,...r}=t,n=C(a);return e.jsx(Y,{...n,...r,ref:o})});ne.displayName=vt;var N="AlertDialogContent",[yt,jt]=ht(N),Ct=we("AlertDialogContent"),se=l.forwardRef((t,o)=>{const{__scopeAlertDialog:a,children:r,...n}=t,i=C(a),u=l.useRef(null),d=S(o,u),p=l.useRef(null);return e.jsx(Ne,{contentName:N,titleName:ie,docsSlug:"alert-dialog",children:e.jsx(yt,{scope:a,cancelRef:p,children:e.jsxs(Q,{role:"alertdialog",...i,...n,ref:d,onOpenAutoFocus:I(n.onOpenAutoFocus,m=>{m.preventDefault(),p.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(Ct,{children:r}),e.jsx(kt,{contentRef:u})]})})})});se.displayName=N;var ie="AlertDialogTitle",le=l.forwardRef((t,o)=>{const{__scopeAlertDialog:a,...r}=t,n=C(a);return e.jsx(W,{...n,...r,ref:o})});le.displayName=ie;var ce="AlertDialogDescription",At=l.forwardRef((t,o)=>{const{__scopeAlertDialog:a,...r}=t,n=C(a);return e.jsx(Ee,{...n,...r,ref:o})});At.displayName=ce;var Dt="AlertDialogAction",de=l.forwardRef((t,o)=>{const{__scopeAlertDialog:a,...r}=t,n=C(a);return e.jsx(F,{...n,...r,ref:o})});de.displayName=Dt;var ue="AlertDialogCancel",pe=l.forwardRef((t,o)=>{const{__scopeAlertDialog:a,...r}=t,{cancelRef:n}=jt(ue,a),i=C(a),u=S(o,n);return e.jsx(F,{...i,...r,ref:u})});pe.displayName=ue;var kt=({contentRef:t})=>{const o=`\`${N}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${N}\` by passing a \`${ce}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${N}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return l.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(o)},[o,t]),null},Nt=ae,wt=oe,Et=re,St=ne,_t=se,Rt=de,Pt=pe,Tt=le;function It({...t}){return e.jsx(Nt,{"data-slot":"alert-dialog",...t})}function Ft({...t}){return e.jsx(wt,{"data-slot":"alert-dialog-trigger",...t})}function zt({...t}){return e.jsx(Et,{"data-slot":"alert-dialog-portal",...t})}function Mt({className:t,...o}){return e.jsx(St,{"data-slot":"alert-dialog-overlay",className:f("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...o})}function Ot({className:t,...o}){return e.jsxs(zt,{children:[e.jsx(Mt,{}),e.jsx(_t,{"data-slot":"alert-dialog-content",className:f("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...o})]})}function Bt({className:t,...o}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:f("flex flex-col gap-2 text-center sm:text-left",t),...o})}function $t({className:t,...o}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:f("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...o})}function qt({className:t,...o}){return e.jsx(Tt,{"data-slot":"alert-dialog-title",className:f("text-lg font-semibold",t),...o})}function V({className:t,...o}){return e.jsx(Rt,{className:f(ee(),t),...o})}function Lt({className:t,...o}){return e.jsx(Pt,{className:f(ee({variant:"outline"}),t),...o})}var _="Checkbox",[Ut]=Z(_),[Kt,M]=Ut(_);function Vt(t){const{__scopeCheckbox:o,checked:a,children:r,defaultChecked:n,disabled:i,form:u,name:d,onCheckedChange:p,required:m,value:v="on",internal_do_not_use_render:h}=t,[x,b]=_e({prop:a,defaultProp:n??!1,onChange:p,caller:_}),[y,j]=l.useState(null),[s,c]=l.useState(null),g=l.useRef(!1),R=y?!!u||!!y.closest("form"):!0,P={checked:x,disabled:i,setChecked:b,control:y,setControl:j,name:d,form:u,value:v,hasConsumerStoppedPropagationRef:g,required:m,defaultChecked:D(n)?!1:n,isFormControl:R,bubbleInput:s,setBubbleInput:c};return e.jsx(Kt,{scope:o,...P,children:Ht(h)?h(P):r})}var me="CheckboxTrigger",ge=l.forwardRef(({__scopeCheckbox:t,onKeyDown:o,onClick:a,...r},n)=>{const{control:i,value:u,disabled:d,checked:p,required:m,setControl:v,setChecked:h,hasConsumerStoppedPropagationRef:x,isFormControl:b,bubbleInput:y}=M(me,t),j=S(n,v),s=l.useRef(p);return l.useEffect(()=>{const c=i?.form;if(c){const g=()=>h(s.current);return c.addEventListener("reset",g),()=>c.removeEventListener("reset",g)}},[i,h]),e.jsx(z.button,{type:"button",role:"checkbox","aria-checked":D(p)?"mixed":p,"aria-required":m,"data-state":ye(p),"data-disabled":d?"":void 0,disabled:d,value:u,...r,ref:j,onKeyDown:I(o,c=>{c.key==="Enter"&&c.preventDefault()}),onClick:I(a,c=>{h(g=>D(g)?!0:!g),y&&b&&(x.current=c.isPropagationStopped(),x.current||c.stopPropagation())})})});ge.displayName=me;var fe=l.forwardRef((t,o)=>{const{__scopeCheckbox:a,name:r,checked:n,defaultChecked:i,required:u,disabled:d,value:p,onCheckedChange:m,form:v,...h}=t;return e.jsx(Vt,{__scopeCheckbox:a,checked:n,defaultChecked:i,disabled:d,required:u,onCheckedChange:m,name:r,form:v,value:p,internal_do_not_use_render:({isFormControl:x})=>e.jsxs(e.Fragment,{children:[e.jsx(ge,{...h,ref:o,__scopeCheckbox:a}),x&&e.jsx(ve,{__scopeCheckbox:a})]})})});fe.displayName=_;var he="CheckboxIndicator",xe=l.forwardRef((t,o)=>{const{__scopeCheckbox:a,forceMount:r,...n}=t,i=M(he,a);return e.jsx(Se,{present:r||D(i.checked)||i.checked===!0,children:e.jsx(z.span,{"data-state":ye(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:o,style:{pointerEvents:"none",...t.style}})})});xe.displayName=he;var be="CheckboxBubbleInput",ve=l.forwardRef(({__scopeCheckbox:t,...o},a)=>{const{control:r,hasConsumerStoppedPropagationRef:n,checked:i,defaultChecked:u,required:d,disabled:p,name:m,value:v,form:h,bubbleInput:x,setBubbleInput:b}=M(be,t),y=S(a,b),j=Le(i),s=Re(r);l.useEffect(()=>{const g=x;if(!g)return;const R=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(R,"checked").set,je=!n.current;if(j!==i&&O){const Ce=new Event("click",{bubbles:je});g.indeterminate=D(i),O.call(g,D(i)?!1:i),g.dispatchEvent(Ce)}},[x,j,i,n]);const c=l.useRef(D(i)?!1:i);return e.jsx(z.input,{type:"checkbox","aria-hidden":!0,defaultChecked:u??c.current,required:d,disabled:p,name:m,value:v,form:h,...o,tabIndex:-1,ref:y,style:{...o.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ve.displayName=be;function Ht(t){return typeof t=="function"}function D(t){return t==="indeterminate"}function ye(t){return D(t)?"indeterminate":t?"checked":"unchecked"}function H({className:t,...o}){return e.jsx(fe,{"data-slot":"checkbox",className:f("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...o,children:e.jsx(xe,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:e.jsx(Ue,{className:"size-3.5"})})})}function Gt(t){const o=[{id:"select",header:({table:a})=>e.jsx(H,{checked:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:r=>a.toggleAllPageRowsSelected(!!r),"aria-label":"Select all",className:"translate-y-[2px] mb-2"}),cell:({row:a})=>e.jsx(H,{checked:a.getIsSelected(),onCheckedChange:r=>a.toggleSelected(!!r),"aria-label":"Select row",className:"translate-y-[2px] mb-2"}),minSize:30,maxSize:30,enableResizing:!1,enablePinning:!1,enableSorting:!1,enableHiding:!1},{accessorKey:"no",header:({column:a})=>e.jsx(k,{column:a,title:"No"}),cell:({row:a})=>e.jsx("div",{children:a.index+1}),minSize:40,maxSize:40,enableSorting:!1,enablePinning:!1,enableHiding:!1},{id:"name",accessorKey:"name",header:({column:a})=>e.jsx(k,{column:a,title:"Name"}),cell:({row:a})=>e.jsx("div",{children:a.getValue("name")}),meta:{label:"Name",placeholder:"Search Name...",variant:"text",icon:Ze},filterFn:Je,enableColumnFilter:!0},{accessorKey:"position",header:({column:a})=>e.jsx(k,{column:a,title:"Instansi"}),cell:({row:a})=>e.jsx("div",{children:a.getValue("position")})},{accessorKey:"badge",header:({column:a})=>e.jsx(k,{column:a,title:"Badge"}),cell:({row:a})=>e.jsx("div",{children:a.getValue("badge")})},{id:"barcodeUrl",accessorKey:"barcodeUrl",header:({column:a})=>e.jsx(k,{column:a,title:"Barcode"}),cell:({row:a})=>{const r=a.getValue("barcodeUrl");if(!r)return null;const n=`${r}`,i=()=>{const d=document.createElement("a");d.href=n;const p=typeof r=="string"&&r.split&&r.split("/").pop()||"barcode.png";d.download=p,d.click()},u=()=>{const d=window.open("","_blank");d&&(d.document.write(`
					<html>
						<head><title>Print Barcode</title></head>
						<body style="text-align:center;">
						<img src="${n}" style="width:600px;height:700px;" />
						<script>window.print(); window.close();<\/script>
						</body>
					</html>`),d.document.close())};return e.jsxs(It,{children:[e.jsx(Ft,{asChild:!0,className:"flex items-center justify-center cursor-pointer",title:"Click to view barcode",children:e.jsx("img",{src:`${r}`,alt:"Barcode",width:100,height:100,className:"w-10 h-10 object-cover"})}),e.jsxs(Ot,{className:"w-fit h-fit",children:[e.jsx(Bt,{children:e.jsx(qt,{children:"Print Barcode"})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:n,alt:"Barcode",width:200,height:200,className:"w-[200px] h-[200px]r"})}),e.jsxs($t,{children:[e.jsx(V,{onClick:i,children:"Download"}),e.jsx(V,{onClick:u,children:"Print"}),e.jsx(Lt,{children:"Cancel"})]})]})]})},minSize:100,maxSize:100},{id:"createdAt",accessorKey:"createdAt",header:({column:a})=>e.jsx(k,{column:a,title:"Created At"}),cell:({row:a})=>e.jsx("div",{children:Te(a.getValue("createdAt"))}),meta:{label:"Created At",placeholder:"Search Created At...",variant:"dateRange",icon:tt},filterFn:et,enableColumnFilter:!0}];return t==="admin"&&o.push({id:"actions",cell:({row:a,table:r})=>e.jsx(ft,{table:r,row:a}),minSize:50,maxSize:50,enableResizing:!1,enableHiding:!1}),o}function Qt({data:t,username:o}){const[a,r]=l.useState(!1),[n,i]=l.useState(null),u=E(Ke),d=E(Ve),p=E(He),m=Pe(),{mutateAsync:v}=T({mutationFn:p,onSuccess:()=>{A.success("Employee updated successfully"),m.invalidateQueries({queryKey:["employees"]})},onError:()=>{A.error("Failed to update employee")}}),{mutateAsync:h}=T({mutationFn:d,onSuccess:()=>{A.success("Employee deleted successfully"),m.invalidateQueries({queryKey:["employees"]})},onError:()=>{A.error("Failed to delete employee")}}),{mutateAsync:x}=T({mutationFn:u,onSuccess:()=>{A.success("Employee created successfully"),m.invalidateQueries({queryKey:["employees"]})},onError:()=>{A.error("Failed to create employee")}}),b=rt({defaultValues:{name:n?.name||"",position:n?.position||""},validators:{onSubmit:n?Ge.omit({id:!0}):Qe},onSubmit:async({value:s})=>{n?A.promise(v({data:{...s,id:n.id}}),{loading:"Updating employee...",error:"Failed to update employee"}):A.promise(x({data:s}),{loading:"Creating employee...",error:"Failed to create employee"}),r(!1),i(null),b.reset()}}),y=l.useMemo(()=>Gt(o),[o]),{table:j}=We({initialState:{columnPinning:{right:o==="admin"?["barcodeUrl","actions"]:["barcodeUrl"]}},defaultColumn:{minSize:160},data:t,columns:y,getRowId:s=>s.id,enableRowSelection:s=>!s.original.barcodeUrl,rowActions(s){s.variant==="edit"?(i(s.row.original),r(!0)):s.variant==="delete"&&h({data:s.row.original})}});return e.jsxs("div",{className:"w-full",children:[e.jsx(Xe,{className:"min-h-[570px] py-3",table:j,children:e.jsx(Ye,{table:j,children:o==="admin"&&e.jsxs(w,{onClick:()=>r(!0),variant:"outline",size:"sm",className:"h-8",children:["Create New",e.jsx(it,{className:"ml-2 h-4 w-4"})]})})}),e.jsx(lt,{open:a,onOpenChange:r,children:e.jsxs(ut,{children:[e.jsx(pt,{children:e.jsx(gt,{children:n?"Edit Employee":"Create New Employee"})}),e.jsx("form",{id:`employee-form-${n?.id||"new"}`,onSubmit:s=>{s.preventDefault(),b.handleSubmit()},children:e.jsxs(nt,{children:[e.jsx(b.Field,{name:"name",children:s=>{const c=s.state.meta.isTouched&&!s.state.meta.isValid;return e.jsxs(q,{"data-invalid":c,children:[e.jsx(L,{htmlFor:s.name,children:"Name"}),e.jsx(U,{id:s.name,name:s.name,value:s.state.value,onBlur:s.handleBlur,onChange:g=>s.handleChange(g.target.value),"aria-invalid":c,placeholder:"Enter name",autoComplete:"off"}),c&&e.jsx(K,{errors:s.state.meta.errors})]})}}),e.jsx(b.Field,{name:"position",children:s=>{const c=s.state.meta.isTouched&&!s.state.meta.isValid;return e.jsxs(q,{"data-invalid":c,children:[e.jsx(L,{htmlFor:s.name,children:"Instansi"}),e.jsx(U,{id:s.name,name:s.name,value:s.state.value,onBlur:s.handleBlur,onChange:g=>s.handleChange(g.target.value),"aria-invalid":c,placeholder:"Enter position",autoComplete:"off"}),c&&e.jsx(K,{errors:s.state.meta.errors})]})}})]})}),e.jsxs(mt,{children:[e.jsx(w,{type:"button",onClick:()=>r(!1),children:"Cancel"}),e.jsx(b.Subscribe,{selector:s=>s.isSubmitting,children:s=>e.jsx(w,{type:"submit",form:`employee-form-${n?.id||"new"}`,disabled:s,children:s?"Saving...":"Save"})})]})]})})]})}function Jt(){const t=E(at),{data:o,isLoading:a}=ot({queryKey:["employees"],queryFn:()=>t()}),{data:r,isPending:n}=Ie();return n?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(B,{className:"size-10 animate-spin"})}):r?a?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(B,{className:"size-10 animate-spin"})}):e.jsx(Qt,{username:r?.user.username||"",data:o??[]}):e.jsx(Fe,{to:"/signin"})}export{Jt as component};
